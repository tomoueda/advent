
ex = """???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1"""

actual = """?#.??????#??#?#?#?#? 1,1,15
.???#??.????#?? 6,5
???????#?#?#?#??#?? 1,1,6,1,1,2
##?..???#?????# 2,1,7
.?????????? 2,2
??????##????#?.?.??. 1,7,4,1,2
?.???..???.?..?## 2,1,1,3
??...??.??? 2,2
????????#?#????#.?? 1,1,7,1,1
.#..??##?.#.?? 1,4,1,1
???#????????.???#??. 1,1,5,6
.?.??.?#?#?.???#?? 4,2
.??#??#?.??.# 2,2,1,1
#.??..?.????.??? 1,2,1,2,1
?.?.?#??.???##??#. 1,1,1,2,2,1
?????.??.??? 1,1,1,1
..?????.????? 2,1
#?##??.??#??#?..?? 6,3,2,1
.???????#?####??#.# 1,13,1
?.#??.????#?.? 3,4
.??.#??#.????????? 1,1,1,4,1,1
???#???????#??#.??? 1,12
???????#??? 1,3
???????.??##???.. 1,6
??????.?#.? 3,1,2
?#.#?????????? 1,1,3,1
?????????? 1,3
?????#?????#? 4,4
????????.?# 1,2,1
?..?????.?.. 1,2,1,1
.?#??#..???##????.#. 5,6,2,1
?..?#?#????#?# 1,7,1,1
????#?#?..???? 1,6,2
.#???.?????. 2,3
???#.?.#??.?##?????# 2,3,2,3
.??????#???. 1,2,2
???##???????##?. 6,1,1,3
??????????..##.? 5,2
#.#?#??#????.?#? 1,3,6,2
??#?????#??? 1,2,2
#?#.???#..#?? 3,1,2,3
.#?????????#??????. 5,8
.?#??.#????????? 2,1,2,1,1
..?????.#?##?.#.#?? 2,1,5,1,2
?#????#???#?#?? 1,1,6,1
.?????#?????? 1,3,5
.#.?.??#?#?#??#?#?#. 1,12
#???.#?????.????#?# 1,1,1,1,2,5
?.???????.#?????#??? 1,1,3,7,1
?????????? 1,1,2
..????#??#?????.?.? 1,10
???#?###?#??????##.? 8,6
..???????#??#????. 11,1
.?#?.?????. 2,4
?.###??##?..?????? 7,4
#??????#????##????#? 1,3,1,5,1
???#.?.???????#??#? 1,2,1,1,6
??#???#?#?##??? 4,7,1
?##?.??.??? 2,1,2
??.??.??###? 1,1,1,3
?#..#???.#??????? 1,4,7
??#?.??##.? 1,3
.??#??..???.?? 5,3
??????.?#??#???#?? 2,1,2,5,1
.????#?.??? 2,1
.#??##??#????#.?.? 9,1,1,1,1
??.???????.??.?#?#. 2,1,5,2,1,1
??????????#??#?#? 1,14
??#???##?. 1,4
?..#????.##?#?. 4,4
??#??#???.?????? 8,1
?.#.#??.??#.## 1,3,1,2
???##?#?.##??. 5,2,1
?.???..?..??????#? 1,1,1,1,1,4
?#????????????? 12,1
??????##??.#????? 6,1,3
????#???#?.?? 1,2,4,1
????????????#??? 1,1,8
?????##?.?#? 1,3,2
??????.#..?????#. 4,1,2,2
?#?#????????? 2,2,4,1
..#?.????? 1,1
??#??#...?. 5,1
?????.???? 3,3
?????##.????. 1,3,1
..?.?????????? 1,8
?#?#?#??.#??#.? 1,1,1,1,4
?#?????????## 2,1,7
#?##?##??.?.?#.?#.? 8,1,1,1
?????#???.##??.?.. 4,1,2,1
?#?#??#.?????????.# 4,1,2,3,1,1
??#?#?#???.????#???. 1,1,1,1,1,7
?????#??????????? 10,2,1
???????.?? 4,1,1
?..????.?????###? 1,3,8
???#????#??#??#.? 6,1,5,1
#.????..#? 1,2,1
.#?.#?#.??.?###?. 2,3,1,4
????##???????.?# 1,5,1,2
.##??##???????.? 7,2,1
???#?#.??????? 3,4
.?##.?.????.? 3,3
#.???#.?????#???.#. 1,4,4,1,2,1
.?.?.##?##??#?? 1,1,6,1,1
????#.?#?#?.?.. 2,4,1
???????#?.?? 9,1
????.#.#.??.????.#? 1,1,1,1,4,1
?.?#??????????#??# 1,4,10
.?.?????????#??? 1,10
.?#??#????#?..?## 5,3,2
#?#?.?#??? 1,2,3
???????#??.?????. 1,7,1,1,1
?.??#?.???????##??. 1,4,2,1,4
?#??#?#???#??# 1,3,3,1
.?.??#.???.????.???? 3,2,4
??#????.?. 2,1,1
?..??#?.#???.?.?# 1,2,3,1,1
##??#????????## 3,1,4,2
??????#?.????.#??#? 2,2,4,4
#???????##????## 1,1,11
#???#?#??#.#??.?#?. 1,5,1,2,3
?##..??.????????? 2,2,3,3
..??#??#???.?? 2,3
#???.??#?.???.?##?? 1,2,2,1,4
??##?#????.??? 1,5,2,1
??###?????.??? 8,2
????????.?#???? 1,1,1,1,2
??#?????#?#?.#???.#? 4,1,5,2,1,1
.????.?????# 1,1,1,1
..???.?.???.? 3,2
??#??.????. 4,2
???#?????#????? 1,1,3,1
.#??#??.?#?###? 4,5
??#??#??..??.????? 2,1,2,3
???#??????##??### 2,1,1,7
????.??#??????.???? 2,1,9,1,1
.#?.###????? 2,4,2
.####?.?.?# 4,2
.?##??????##.?. 7,3,1
????.?##??# 1,5
###??#?#????????.. 8,6
?.???#????.?.?#????? 6,1
????..?????? 2,1,1,1
.????##.????. 6,1
?#??????????? 3,1,1,1
??.???#????#?##?. 1,13
?.?#??#?##???.???..? 9,1,1,1
??#?#?#.?#???? 7,4
??###???????. 6,2,1
??##?#.???.?##?? 3,1,2,3,1
????????.#?##?????.? 1,2,1,4,4,1
??.??????????.?????? 9,1
.#?.?#???#?????.# 1,8,1
??.?????#????# 1,2,1,2
??#.??#..#?? 1,1,2,3
#?..??##??#?? 2,8
????#???#????# 10,1
????????#?#??? 1,6
???????.??.#????## 1,4,1,1,1,2
???#?????.??#.??.?? 1,3,2,3,2,1
?.?.#???#??#?????? 2,7
..#?.?.??#? 1,3
???#?#??..???.?? 5,1,1,1
.????#?.??##??#?# 4,7
???#???#?##?????? 2,6,5
.?##?#?##??#?#?.???# 2,1,8,1,2
???????.?#???? 3,4
#.?#??????.??? 1,4,1,1
?????#???.. 1,5
.#???#???????#?#?? 1,1,6,2
#???####.#??.??? 1,5,3,1
??#??..#?.?? 3,2
?#.????#??#.#? 1,1,6,2
..?##?.?#??.#?? 3,4,2
?..?????.? 1,2,1
..??#??#??#????.#? 11,2
????????.????##??? 1,2,1,6,1
???????#??#.?.?#??? 10,3
.#.???#.?. 1,2
??????#???#..?? 2,3,1,1
?????###?.??????.?# 9,1,1,1,2
??##????.?????????? 8,1,1,3,1
??##??.#?.#??# 3,1,1,1
?#???.?##?????..? 3,5,1,1
#??????????.#???#??? 5,1,3,2,2,1
??.#..????????? 1,6
?.?#??#??..?? 3,1,1
??????.?..???. 3,1
??#???#??.??? 8,3
??????.#??????? 3,5
??#..?#?.???#?.. 3,2,4
????..???#? 3,3
?.#????????.??.#??# 4,1,2,1,2,1
??.?##???##???? 1,3,6
#?#.??#?.?### 1,1,3,4
?.#?.??#?????? 1,2,6
??.#.?.?????????#? 1,1,7,1
?.???##???#.?? 5,2,1
????????#?#..# 7,1,1,1
?#?.??.?????.??# 2,2,3,1,1
.??#?####??????? 10,1
.????.##??????#??#. 4,12
.?.??#?##???#? 6,2
????##????? 1,3,3
?#?.????#??#???????# 2,11,4
??..???.??. 1,2,1
????????#??.?????.?? 2,4,2,1
??????#??..#?? 1,1,5,1
???.#???#? 1,4
???.???????????? 1,1,1,3,1
??#???..?#?#?? 2,1,6
?.??#?.??.?.???.?? 1,4,1,1,1,1
.?.??.?##??#. 1,2,4,1
????.#???????##??# 1,1,1,8,2
?.?#????.?.#??#?#?#? 1,1,1,1,1,9
??##??##??#???? 3,2,1,1
#?.?.?#??#??#.? 1,1,6,1,1
?????.?????? 1,2,2,2
.???#??????#??#?. 5,7
.????##?#?#????.??? 8,1
?.??#?#???.#????. 1,6,1,1
.?.????.?.?.#???#?? 1,1,1,1,1,6
??##??##.????????.. 7,3,1
..#?.###?#??????#?#? 1,8,3
???##..???? 2,2
?.???#???????##?##? 1,6,6
?...?..?#?.? 1,1,1,1
???#??#?.?#?. 1,2,1,2
??????????.???????.. 3,4
?????.?????.?#?#?# 3,1,4,6
?#???.?????..# 3,2,2,1
#?.#???#???.?#? 2,1,2,1,1
?.#????#?#??? 1,3,1,1
.?#???.??? 4,2
??????##?????.#?? 2,6,2,1,1
#??#?#??????. 1,2,5,1
?#??##???.??#????.? 2,3,1,1,1,1
#.?????#?#..#? 1,1,5,1
.??.#.?#???? 1,5
?##??#?????. 7,1,1
??.???.??# 2,2
?.????.#??##??#???#? 1,1,1,2,5,4
???????#???? 4,1,2
?#.?.????????? 2,1,4,1
#????##?#??????.?.?? 1,2,10,1,1
##?.#???#??????? 2,1,1,8
???.?????????# 2,1,1,5
???#.??#??.?.??. 1,2,4,1,2
??#?#?##???.# 1,8,1
???..#?????????#? 1,1,1,6
??##??..??????#?.? 1,2,1,2,5,1
???#??###?#.?? 2,5,1
?#?#????.????##? 5,2,6
?##??.???.??##?###?? 2,3,1,6,1
#####????????.? 5,6
.?.??#?.#?.?? 4,2
?#????.??#?. 5,2
????#??.####?. 5,5
???????##?#???#?.#?. 2,11,1
??###?#??????.??.## 4,1,2,1,2,2
?####????#.??#.? 7,1,1,1
????#?.#?? 4,2
??.??..??#????? 2,2,6,1
#??????#?#?..??? 1,1,7,1
#?????????????#??# 1,1,1,1,6,1
?#??.?????.???.# 3,4,1,1
??#????????.?#????? 1,4,3,7
??????.??.#????????? 2,1,1,1,5
?..??##.?# 4,1
??#???.#?? 4,1
?.??????????????? 1,2,6,4
.???.#????.?# 1,2,2
.##?#?????# 4,1,2
.??#?##.?#?#?##.. 6,6
???.?#?###??? 1,8
??#?#?#??.?.??#?? 7,4
????##????#?????#? 14,2
.#.#?#??.?..???? 1,5,1,1,1
#?#?????#?.???#???? 10,5
?????#?..?.??. 5,1
?#?#????#? 5,3
??##.???.???# 2,1,3
?#?.?????? 2,1,3
.????#???? 3,1
?????.???..? 3,1,1
???????#?????? 7,3
?????????# 3,1
????.??#???.?? 2,4
??????????#?? 1,8
???#??????##??#?..?. 14,1
????.????????.???. 1,1,1,1,1,3
?#????#???? 2,4,1
##?????#?. 3,2
??#???..?#.???? 2,2,1
??#???????##.?? 2,2,4,1
?#???#?#.?# 8,1
.??????.?? 1,1,1
?#??##?????????? 6,2,2,1
#????..##???? 1,1,2,1
????##???#?.???..? 10,1,1
??????#????# 4,6
??.??#.??.? 1,1
.?.?.?##??.#???? 1,4,3,1
????#?...??##??#?#?? 4,8
?#?????#????.??????? 12,1,1,2
?###??????#? 6,4
#.?#?#?#??#?#? 1,1,9
?.???##??#??#??????? 11,3
?#????#????????...# 3,3,3,3,1
.#?..#?.#???? 2,1,2,1
??..?#.??????? 1,2,3,1
?#..??#??#??? 2,8
??#???.???##?. 1,3,1,4
????#?#?#?#?.??.# 3,8,1,1
??????#??? 2,1
#??????#??#.#??# 5,5,1,1
?.???.?##??? 2,3
?????????.?? 1,1,1,1
????????#????.#??? 1,1,6,3
?##.???.?##? 3,1,2
?????????????????#? 1,1,1,1,1,5
???#.?#.??##???? 2,1,4
.????.?..? 1,1,1
??????.##?#?? 1,1,4
?#???.???? 2,1,2
#????#??#?#..?? 11,1
?..????###?????#? 1,1,4,1,2
?.#???#???#??. 1,9
.???#????..???.? 3,2
???.??#???.???? 1,1,6,1,1
???##???#? 2,2,3
???????#????.??#?? 1,4,2,2,1
#.#??#??????#? 1,4,1,4
.??#?????###?.??# 4,5,1,1
.??????#?. 1,3,2
#?#?????#?.????#?? 4,3,3
????.?#?.?? 2,1,3
?.??????????????.?# 1,1,4,1,1,2
?.#.#?????#? 1,3,1,1
??.#??.?#???#????#.? 1,2,3,6
??...?##?????. 1,4,2
.??.???.?? 1,1,1
.#??#.??.#?.?#?. 1,2,1,1,2
#?.????#?. 1,5
???##??????#??#. 8,3,1
.?.????#?##?## 1,1,7
???#??#?????? 2,1,1,1
???#??##???.?? 2,6,1
####??#??.?#??? 9,1,1
???.#??.?.?##?????.# 1,1,1,1,8,1
##.??????#?? 2,7
.??..????????#???? 1,8,1
#????#?#?#?? 4,1,3
?##??????????#??? 4,3,7
??????????#?##????? 1,7,6
??????#?.??. 1,2,1
??.?.?#??.?.##? 1,1,2,1,2
????.??#?#????? 1,5
?????#??#.???##??.# 1,4,3,1,1
.??#????????.?.?# 1,9,1,2
????#??.#???#??##?# 3,11
?###.??#?????#???#?. 4,1,1,2,1,3
?##?#.?????.????. 4,1,2,1,1
????#?.??##?.#???? 1,2,5,2,1
?#?#??.?#?? 4,1,2
.?#?.???#? 1,3
#????##?.##?#?.?? 8,4,1
.#.?.???#?? 1,1,2
?????##?????????#? 2,10,1
????..?#?#???????##? 1,13
????#?#????.??### 8,1,4
???????#???. 1,1,4
.??.#?##?#?.?#???.?. 7,4
#??..#???#?????.??#? 1,1,8,1,1
???.??.???#?? 3,1,1,1
?#??#???.???? 5,1
?#?.??#??##??##??.? 1,11
#?#??#??##???????? 1,1,1,8,2
???##?????#???.?.?? 1,9,1,1,1
??.???????????? 1,1,2,3
???.?.?#????#??? 1,8
??##??..#..? 2,1,1,1
??????#??????? 1,8
?????.#?#??.#. 1,2,4,1
?#.?#?#?##????#? 1,7,2
???#??????????? 1,6,3
?????#?????#.???. 1,8,2
???##..???????#???? 3,5,1
.??#.?.#?? 1,1,1
???.?#???? 1,1,1
##???.?#??.?.?.#..?? 5,2,1,1,1,2
???#??.?.?? 4,1
.???????###????#?? 6,4,5
???.??#?#???#????### 2,1,4,1,1,4
#?..???.????..?## 2,2,1,3
????#??.#????#??#.? 1,2,6,1,1
#??.##?#.?.?##????? 1,1,2,1,5,1
?????.#?#?#?? 2,1,5
????????????#???? 4,1,3,1,1
?.?#??#???.???? 6,2
.?..???.?#.??? 1,1
??#???#.??????? 1,2,1,5
#####?#????????? 8,1,2
???.???#???.. 1,1,4
??###..?..#???# 5,1,3,1
.?####?##.????? 7,2
?#???#??#???..? 1,3,3,1
.??##??????. 1,3,1,1
????.????#??##?????# 4,1,9,1
??#??.???#.#??? 3,1,1,3
??????#??.?..??#..?. 1,7,1,3,1
#???#.??????.???..? 5,2,1,1,1,1
??????????.???? 2,1
##?##???#????.? 5,5,1
..??.?.???.?? 2,2
#????.??#?#????.?? 4,4,1,1,1
??.??.????????#. 1,1,3,1,1
.#####?#??????#??. 10,4
?????????????#?.?? 2,7,3,2
?????#??#?? 1,3,4
.?#?????????#??? 2,1,4
#.??#??##????#??#? 1,15
??????.???.? 1,1,1,1
???.#.##??#.?###? 1,1,1,5,4
..?#?##.??????# 5,2,3
#???????????.?????. 6,2
??#??#.#???#?? 4,1,4
????.???#?. 1,1,3
????#????#?#.???#?? 1,8,1,2
?????.##????#???? 5,4,1,1,1
??????.????? 2,1,1,1
?##?????.???#? 6,1,1,2
?.#??#?#.??#??.#. 1,1,4,4,1
#?.#???.?.?#?????? 2,1,1,1,4
????#??????.????.. 2,2,1,1,2
?.###??.?????.# 5,1,2,1
???..######.? 1,1,6,1
.##???????.# 3,1,1,1
#????.????????? 1,1,1,1,2
#??#.#?????#??.???# 4,1,1,2,1,1
?#???#??#.???.. 5,1,1
???#?????#???? 3,1,4
.???.?????? 2,1,1
???#???#????##?? 4,1,7
??#.??.???#?????#.? 2,1,1,6,1,1
?##.??#????.?#?#??. 3,2,3,6
.#??#??????#?? 2,9
?.???#??.???#?# 1,1,1,1,6
????#??#???.? 1,1,4
??????#?.????#?###?# 6,11
#????#????#??#..?? 1,4,3,1,2
???#??..#??#??# 1,3,1,5
??.???##??####? 1,1,3,4
???????????#.. 3,4,1
#?#??.#?#?#?? 5,1,4
?.??#??#???##???? 1,1,1,3,2
?#???????#????? 12,1
?.?????#?? 1,2,1
#????#??#????#???##? 1,1,1,2,9
??###??#?#???#.??? 11,2,2
#?..??#???.? 1,5,1
??#.?#????#?????? 1,3,2,1,2
??#??????##???? 6,3,1
.#?.?#.#??#??.#?#?#? 1,2,1,1,1,5
?#?#???.?#??#.. 1,1,1,2,1
????#????##.?# 1,7,1
.??????????????#... 3,3,1
..?..?.?##?? 1,5
??#?...##?#?#? 2,2,4
.????.?#.?.. 4,1
??.????#??##??#???? 1,9,6
...?#??.?.. 4,1
?.?.#..??..# 1,1,2,1
???##??.??. 2,3,2
?#?#????????.?#???? 1,3,2,2
???##?????. 5,2
???#??#??###???#.? 6,5,1,1
???.???..##??#?#### 2,1,1,3,6
??#??.?#..#.? 1,1,2,1
.????#??#.?###?##.? 1,1,1,1,6,1
.####?????? 4,2,2
?.?#?#??????.??#?. 1,6,1,2
????????????? 8,3
#?##?????.?? 4,1,1,1
??#????#????#???#? 3,1,1,3,1
.#.?.#.?#?#.? 1,1,3,1
?#.??#???.?????? 1,5,1,1,2
..????????. 2,3,1
.????.#????#????? 1,1,3,2,2
..??.???.#?.?##?#? 1,2,2,4
??#?#?#??##????? 1,10,1
.??????#???. 1,1,1,2
.?....#???? 1,4
?##??..???????.?? 5,1,1,2
.?.??????#?. 2,4
?????.??#??#? 1,2,7
?#????.??????..??#? 5,5,3
#???.#?###????.? 3,5,1,1,1
#?#????.??#??#?? 6,5
#?#????.??##????.? 7,4,1,1
.#?.?????# 2,2,1
?.??#?.#????? 1,2,1,3
???#?.???..# 1,1,2,1
?###??#?????? 6,1
?????#?????.? 4,1
.???..#?.?????#? 3,2,3,1
.?#?????.?# 6,1
#???????.?? 1,6,1
?#..?#???? 2,3,1
?###??#??#.?.???. 9,1
?#?#.????#. 3,3
???..?..???#????? 1,1,2,5
???..?##???.?.?#??# 1,4,1,1,5
#?????#.?? 3,2,2
.?.????#???????. 1,5,2,2
.????????#???? 8,1
??.??#??????#???#?? 2,6,1,1,1,1
?#????##??????#??? 13,1,1
???.?#..#??#?#??#?## 2,2,12
.???#????????.. 5,2
.#??.???#??..?#?? 1,2,3,2
??.?????##??.??? 2,1,1,4,1
?#.???#??##.? 2,5,1
???????#?#??###???# 2,1,9,3
?#???.??#???. 3,4
.#..????#??????#.??? 1,4,3,1,1,1
#???#..??#? 5,4
?.??#?.???????#?#? 1,1,1,1,2,5
.?????.??.??.? 2,2,1,1
?##?#?#?... 4,2
###??.????????.?.?.? 4,1,1,2,1,1
???#.?#?????.???? 1,1,7,1,1
???????.??.????? 7,2,4
??#?###??.????????? 9,2,3,1
?#?#?#???#.???#??#. 6,1,1,4
?.?#???#..? 2,1
????.???#?#?.?#?.?? 4,6,1
?????#?????#.? 1,2,1,1
?#.#.?.??###??? 1,1,4,1
?#.???.#?.?? 1,1,1,1
??..?#?##? 2,6
??????.?##?.??????? 1,1,1,4,1,1
???#??????? 4,1
???????#?? 5,2
?#?????#?#?? 3,4,1
#?###????#?..??##??? 10,4,1
.???????#?# 4,2,1
#???????.?#?? 1,3,2
..????#?...??????. 2,4
.?????????? 1,1,2
??.?.??????####? 3,5
?.??#??????#??.???# 1,1,9,1,1
???.?.?#?#??? 1,4
?.??##??#? 1,2,2
#??##.???.? 5,1,1
?????.?????????. 3,2,3
?.??.??#?#??. 1,5
?????##??#????#. 1,3,2,4
.??.?#????.#???#???. 2,1,1,1,5,1
.#?.?.??#.?? 1,1
???#?#?#.?.?????.? 1,6,1,1,1
###??#..#..??#?. 4,1,1,1,2
.#???????#.?# 1,5,1,1
????????#???#??????# 1,15,1
.?#??#?#?#??#.??? 2,9,2
????##????#?###???. 12,2
?##??.??.#?#####?#.? 2,1,1,7,1,1
#??????..?#?##?#? 5,6
.?.#????.??????.??? 1,2,6
?#?##?#??????.???#? 7,1,1,1,1
.????????#?##.?.?? 1,8
?????##?#.??###?..? 5,3
#..?#?###?#????.? 1,7,2
???????#.??#? 7,1
?#????????.? 8,1
.?##?#?#?.#??? 7,1,1
.?????????.?????? 7,1,1,4
????#?#.???????#??#. 5,10
.?#???????.?? 3,1
?????.?#?? 1,1,1
????#?????#?.?#. 1,9,2
???.???.#?# 3,2,3
??#.###??#.?.? 1,6,1
#??#?#??????#????? 1,3,6,1
.??#????????? 2,1,1,3
???????.????????? 6,4,3
?###?#?#?..???.??? 9,2,2
?#?###?????.???# 6,2,2,1
?.?.??#?.. 1,1
.?#??#?.???? 6,2
???##??????#?.?.. 9,1
??##?#???????? 8,1,1
?##?#?#?#?#????##.#. 16,1
#???.????#?#?#? 4,1,5
?.??..??#??.????# 1,1,5,2
.???.??????? 2,7
?##??????#?? 3,3
.?#.?.??#? 2,2
..?.???..? 1,1,1
.???.#??????? 1,6
????#???#???###?.? 1,6,4
????.#????##.#?#?? 3,1,4,1,2
.??#??#?.?????. 6,4
?#?#???.??#??? 1,1,1,5
???#?#????#???? 1,5,1,1
??.##??#????.?? 1,2,2,2,1
?#..?????????#??.... 2,1,3,2
??#.????.? 1,1,1
?.??#?..???. 3,1
???????.??#?? 1,1,3,2
?##?????.??###.. 2,2,4
????????#???#???? 1,2,4,2,2
????.?.?????#???? 1,1,1,6,2
???????#?????.??# 10,1,1,1
???#??#??## 1,4,2
????#???#.?????? 7,1,3,1
?????????.?. 1,7
.#???.????#?.#.? 4,5,1
###???#.??. 7,1
???#??.???...?????? 1,3,2,1,1,1
????.?.???.? 3,1,2,1
##??????.???## 3,3,1,3
??.?.?????#??#??# 1,6,2,1
.?????????????# 4,2,1
#??.?#?.?.?##### 1,1,1,1,6
?#.???.????. 1,2,1,1
.?#???.???? 2,3
????.#?????????. 1,1,2,4
???#??????#??#?# 1,3,1,6
.#??#?..????#?#? 5,4
?.#.??.?##???#??#? 1,10
??#.#?..???#?#????.? 1,1,10
...???.#????...??? 3,1
???#?.?????????. 4,1,7
??#??#????? 2,3,2
??????#.??#? 3,1,1
???.?.?????#??.##? 3,1,3,2
.?..??#????.?.??.? 1,5,1,1,1
?..?..##??.??##..? 3,3
#??????#?#?? 1,1,2,2
#?.?????????????#??. 1,6,1,1,1,1
?.????###???? 1,7,2
?.????####???# 1,9
???????#??.#?????? 1,5,1,1,1,1
??.#?#???#.?. 1,5,1,1
###??#???# 3,2,2
?##..?????# 2,1,4
.??????##????. 8,2
?.?????.#?.??????#?? 1,2,1,1,7
.??#?#??.??? 1,1,1,1
#?.#???#?.???. 1,1,3,2
?.??.????????#? 1,1,3,1,1
???????#??????#????# 1,4,9
.?#????????#.##?# 4,1,2,4
??#.?.?##??.. 1,4
???.??.?#?..? 3,1,3,1
?????...????? 4,4
?###?????.?.? 7,1,1
.?.???##?.??.?.?. 1,1,3,2,1
?#??????#????#.????? 2,2,4,1,1,4
.?.??????? 1,2,2
????#?#??#?????#?.?? 1,7,2,2,1
.#???##?#??#?##?#??? 6,1,9
?????????? 3,2
????#???####?.? 1,1,6
??.????.?..?? 1,2,1,1
??????.#?#??? 1,1,3,2
????????.??? 6,1
?#?#????????.? 7,1,1
??#?.#??##???## 3,2,4,2
??????#?##?#.?? 11,2
???????????#??? 1,1,1,4
???#?#?.#?????#? 5,1,1,1
#.????????#? 1,2,1,3
?.?#??###?.#?? 7,1
???#.#.???.#??? 2,1,1,3,3
??????#??.? 2,4
.##???#?????????. 10,2
?.??????#????#????? 6,5
???#??#?.? 2,2
?.?????#???? 1,1,1,3
??????###???#?##? 3,4,6
????#.???#????? 3,6
.??#?.??.????#.?.??. 2,1
??#??#??????#?#? 2,6,4
.#???.???#???.# 4,7,1
#.?.#??#????. 1,2,2,1
???#.?#??#?????? 2,2,3,2
#.??#?#??#?###??? 1,12
.???..#?#????.#?? 3,3,1,2
.????##?.#???? 5,5
??.??.?.??? 1,2
??????????#? 1,1,3,1
#???#??.??? 1,3,3
..????..#? 1,1,1
??????#???????? 3,3,1,1
???????#??#?????#? 2,9,1
.###?.??#?## 4,1,2
???????????.?.?##?? 8,1,5
??????#.?#???? 4,1,2,2
?#??.?#????#.????? 3,2,2,1,1,1
???#??.?#?##? 3,4
????##????????#??? 3,7
??#?????????.#.?? 7,1,1,1
#??#??..#??. 6,1
??????#???. 2,1,1
..?#??.??#??.?? 4,3,1
?..????.?????###? 2,1,5
.?..???#?#.??.? 6,1
..###??#.?##?##.??#. 6,5,3
??#?.????# 2,3
??????#?#????##?? 3,1,1,5
???????????? 4,3
#??#??#??#?. 5,5
??#???.##???????? 5,3,1,1
??????#?????????# 8,1,2
??#???##?????.#. 3,7,1
.???#.#????????#.?? 3,10,1
.?#?????#??.# 6,2,1
?.#??#####???..? 1,1,9,1
?#..?????#?.?? 2,1,4,1
?.?##?.?#?.?..? 1,3,1,1,1
?##.#??#?..?##?####? 3,1,3,8
.??#####?.?????# 7,4,1
?????#?#?????? 1,1,1,7
????#.#?????.??? 2,1,5,1
??????????#?????#?? 4,1,1,4
#???#???.. 2,4
??##???.?##??? 5,5
?.??##?.????..#.??? 1,1,3,2,1,3
..?????.#?.?. 1,2
?#??.?.?..#.? 2,1,1,1
??.#.??#.?#. 1,1,1,1
?#?#??#??##?????#?? 1,1,6,6
...??##?###?.?? 7,1
?#.?#????.. 1,3,1
??.????#??? 1,1,4
????##????????.??? 2,7,1,1
???????###??#.? 1,1,1,6,1
?.???#????# 1,5,1
..?????#????????. 1,11
?.?????#???###??.? 1,5,3,1
.????.#?.##?? 2,1,2
??.???###???????.# 1,1,4,3,1,1
.??#??????? 3,2
.?????#?????.????# 1,5,1,3
?..#.????#??.?? 1,3,2,1
.?????.???.#..??.? 3,1
?#.?.????#??.???#?# 1,7,6
.#???#??#?#??#? 11,1
#.?????#?????## 1,7,2
???#?##???#.???? 7,1,1,1
?????#??#???? 1,9
#?#??.???#????##? 3,11
.#?#??????.?#??#??# 7,1,5,1
??#?#????? 1,5,1
????#????#.?.. 9,1
?##.?.?.??.# 3,1,2,1
??#?.?.??#??#?###? 2,1,1,1,1,3
?.??..?#???##? 1,1,8
#..#????#?.# 1,2,1,1
#??.#??.??.?. 1,1,1,2
??#??????#??#????##? 1,6,7
???#???????#??. 2,1,5
#???????#??. 1,3,4
.?#?????????#?????? 1,10,1
?????##?#??. 3,5
???.?#???#?? 1,2,2,1
#.?#?.?#?.?# 1,2,1,1
????????????????.. 2,1,3,2,3
??#???#.???#?#?? 4,1,6,1
?.#?.????? 1,1,1
.#?????.?##??#. 1,2,1,6
#?##??#?.???????. 1,5,1,3,1
?#..?#?.???#. 1,2,4
??.????.?????#??# 2,1,1,6,1
???#?????#? 3,1,1
.#?#?#?.??? 6,1
??##??????? 2,2,1
#????#???? 1,1,4
?#?.?#??????? 2,1,4
??.???.##???#?#???? 1,1,1,9
????#?.??####? 1,1,6
#??##????.????#. 9,2,1
?#?????.?# 1,1,2
?.#?????#??# 1,1,2,4
?.??#??###??#..#? 1,9,2
?#??.?.?#?.? 2,2
???.??.??#? 1,1,1
?#??...#????###?#?? 3,11
?????##??#??#??# 1,1,6,1,2
????????.#? 2,1,1
??#?.??..#?##?.??. 1,1,1,5,1
..?#.?.???. 1,2
??###.##??? 1,3,4
???#?#..???????# 6,1,2,1
?.?.?????##?#?????. 9,2
.???##.?.. 1,2
?.????????##?. 1,4,1,3
?.????.##?????? 1,1,1,5,2
.??????##??#?#???? 1,9
?.#.???##??????? 1,1,1,4,4
.?#????#????. 2,3
.?.?##????.? 1,3
#?.?#??#?.?..??#??#? 2,4,1,3,1
??#????####?? 2,8
?.??#????????##?? 4,4
.##..????? 2,1
#????#????.??.? 1,4,1,1,1
#?#??????.??###?#??? 1,1,1,1,8
??.?#??#??????? 2,1,5,1
..?.???.??????? 2,3
?.????.?#???.?#?? 1,2,5,2
.#?????#?.?? 7,1
?#??.?????#?????#? 4,1,4,2,1
????#..???. 3,1,1
????##????#?#??#??? 1,3,9
.#??#??.?????#? 5,2,2
?#?..???#?? 1,4
???##?.?????#???#. 5,8
###?.?????? 3,3
?..???#?.#??#.??#.? 1,4,2,1,3
.?.?????#???? 1,3,1,3
?##?????????#?#??.. 3,1,8
??#?#??#????.? 4,2,2
#?????.#????#?#???#. 1,1,1,12
.??##????????.#??#? 10,4
#????.???.#?.##??#?? 1,3,1,2,2,2
#?????.?#.??? 4,1,1,3
.#??.??#?????##??#? 3,11
?.?????.??.???##? 1,2,5
.???.#??#??? 2,6
.????.?.#? 4,2
??##??????.#?#????. 8,3,1
.##??.?##?#??#??? 3,8
##.??#??..? 2,2
??.???#?####? 1,1,8
..???#??.???????###? 4,1,8
?????????#??????? 1,13
?.#??????#???#.?? 8,1,1
.??###??#??????# 1,6,1,1,1
????..??#??? 1,1,3,2
#??.???????. 1,3,1
?#?##???#?#?? 9,1
????#???#.?#??#?#??? 7,5,3
??.????????????? 1,1,1,5
??..????????#??.?? 1,1,6,1,1
.??????.#???? 3,1,2
?#???.#?#???.#??? 3,5,3
????????#??####?#? 4,11
??#??#???? 6,2
.#?????#??.??.???.?? 9,1,1,1
????.#?#?.???? 4,1,1,4
#?????????.? 2,1,2,1
.###?????# 6,2
????????????#??##??# 1,1,5,5
??.??????. 1,3
??#??????##?#?? 1,1,1,1,5
?.#???????#?? 1,3,5
????????.###???? 1,2,1,7
.??#????#???..#?# 2,5,3
???##??##?#????????? 1,9,2,3
#??##??????..?? 1,6,1,2
??????.?.????? 3,1,1,2
??????????????? 9,2,1
.??????#.??.??# 1,1,1,1,3
??????#???##?###??# 1,1,1,11
???????????.#???.?#? 4,2,1,1,1,2
?.???????#????#? 6,2,1
#?#??????????##. 3,2,5
.?.#??.?????.???#??? 3,3
??..??.?##??#? 1,1,3,1
?#???#????.???.?? 8,1
#.??.?????.##???.? 1,2,1,1,5
?.??#?.?###? 3,3
..????????? 3,1
????#..?#? 1,1,1
?#?????????? 2,1,1,1
???#.?#?..?.?#? 2,2,1
..#?????.?. 1,2,1
?.#????#?????#?.? 8,3
?????????#?????. 2,1,1,1,2
???#?##????? 1,4,1
????.?#?#????.?#? 5,2
.??#???###? 3,5
.#?.?.??#??##. 1,1,6
.?..?#????..????? 2,1
.?#.##???.?#?. 2,5,1
#.????.#???#?#. 1,3,1,3,1
.?.?????#?###?## 1,1,6,2
?#?????.??????.? 4,1,3,1
??#??.#??.? 5,2,1
?.???.??.???#? 3,1,1,1
???.???.??????#??? 2,6
??.?##??#???## 7,2
??.????#??.??#? 5,3
#??####???????.? 12,1
?.???#??#?#?#?# 2,10
???.?????#???. 1,1,9
??.???##????#?#? 1,10,1
???.???.???#.. 3,4
.?#?.??#?#...????#.? 2,2,1,3,1
.????#?.?????#?# 1,3,2,4
???##????????????#?? 5,11
?##?????#??????? 6,2,1,1
??#.????#?#??#? 1,6,1
???????.?#? 1,3,2
???#???.??##?#?. 1,2,2,4
#????##???.???.. 10,2
##.??????. 2,1,3
.??????.???.??.#??# 1,3,1,2,2,1
#?.???####??#?#??. 1,11
????#?????#?.? 3,5
??????#???#??.??? 1,5,3,1,2
..???.??##??#???. 3,2,2,1
#?#.#?????#??#??# 3,10,1
.???##?##?????#?.. 5,9
?????#????#.? 1,4,1
###??#???#? 3,1,2
?.?????#?#????#?? 1,14
?#??#???????#?????#? 1,1,1,2,5,2
???#????.?.? 2,2
???##????##????? 11,2
??#.???.?. 3,2
??##??##??.#??. 8,1,1
??.?????#?? 1,2,1
.#?#.#??????..#. 3,1,1,1,1
???####?#.???#?#. 1,4,1,1,4
#?????##?#..???? 1,6,1,1,1
.#?????.?? 1,1,1
???#?#???#?#?#.#??#? 6,1,1,3,4
.???##??????##.?? 3,5
##???#??.???????## 3,2,1,1,1,2
?..##?????? 1,2,3
????##??.?##??.???? 4,4,3
##?#?.?.?.??.? 2,1,1,2
?..??.#?.???#. 2,1,1,1
??????.?#???? 1,1,4
????.?????#????? 1,9
.???#??#????#???? 1,10,1
?.?#?.?.???#?.???# 1,1,2,2,3
#???..?#.#.#?#?.?? 1,2,2,1,4,1
??????.?.??????? 2,2,1,1,1
?####?#.##?.?#?. 5,1,3,1
.?????#??? 1,5
??.#???#.??# 2,2,2,2
??#????..???# 2,1,4
????.?#???#?? 2,2,2
#?#??#?##?#.???.? 1,9,1,1
#??????????###?? 1,1,2,1,5
.?????##??..?# 6,2
..#?????#???.#?.??? 2,4,1,1
??.???#??#?????# 1,2,10
??#???????.#? 3,2,1,2
?????????.???#?? 2,1,3
?#?.???????#???.#? 1,1,7,1,1
????.??#?.?.? 1,4
###?????#???????.? 6,1,1,4,1
????.##???. 1,2,1
??.?????.# 1,1,1
.??.???.?? 1,1,1
???#????????.##?.?? 1,2,5,1,3,1
???????.??????? 1,1,1,2,1
??#.????.. 3,1
.??##????#.#???? 9,2,1
???#.???#???#??. 1,1,1,7
??????.#??.? 1,1,1,1
?##..??###??#?#?..? 2,1,9
??.??#.###???# 1,2,4,2
????????##. 2,4
??##.???#??? 3,6
?????#.?#???? 2,2,5
#???.??.??#.# 3,1,1,1
.??..##.??. 1,2,1
???#.???????? 2,1,1,2
????#?.?#?#? 1,2,2,2
???????.?.??#???. 5,5
???#??????#??#???? 1,2,1,2,3
?#.?..???#??#??.???. 2,1,9,1,1
????.#?#.???? 2,1,3,1
#.??##???..#? 1,6,1
?????#???????## 8,2
??.??..?#???.?? 1,1,2,1,1
????.##???.?.?##? 2,5,1,4
?#?#?..?????#?? 1,1,5
?##??????#?? 2,4
#.?????#??.##????.# 1,5,1,5,1
?##?.???.? 3,2
?##?#????#???.??? 12,1
?..?????## 1,7
?#?#??????#?? 1,9
?.#??##???.????? 1,4,3,1
?###??????? 3,1,2
??????.??. 1,1
???.??#??#??#?.#. 2,5,2,1
?.??????.? 2,1
.?#???????????? 2,3,1,2,1
.??.?.??????? 2,1
.?#.???#?????#??.? 1,9
??????#??.# 5,2,1"""

lines = actual.split('\n')
from itertools import combinations

def find_qs(string):
    indices = []
    for i in range(len(string)):
        if string[i] == '?':
            indices.append(i)
    return indices

def is_legit(springs, arrangements):
    local = []
    n = 0
    for c in springs:
        if c == '#':
            n += 1
        elif n != 0:
            local.append(n)
            n = 0
    if n != 0:
        local.append(n)
    if local == arrangements:
        print(''.join(springs))
    return local == arrangements


def num_springs(springs):
    s = 0
    for c in springs:
        if c == '#' or c == '?':
            s += 1
    return s

def pos_arrangements(springs, arrangements):
    indices = find_qs(springs)
    expected = sum(arrangements)
    s = num_springs(springs)
    n = 0
    for i in range(0, len(indices) + 1):
        if i + s != expected:
            continue
        combs = list(combinations(indices, i))
        for c in combs:
            sample = [x for x in springs.replace('?', '.')]
            for j in c:
                sample[j] = '#'
            if is_legit(sample, arrangements):
                n += 1
    return n

def find_all_possible_placements(spring, seg):
    possibles = []
    for i in range(len(spring) - seg + 1):
        sample = spring
        clip = ''.join(spring[i:i + seg]).replace('?', '#')
        next_idx = i + seg
        if clip == '#' * seg and \
                ((next_idx >= len(spring) or spring[next_idx] == '.' or spring[next_idx] == '?')) and \
                (i - 1 < 0 or '#' not in spring[:i]):
            first = ''.join(sample[:i]).replace('?', '.') + '#' * seg
            if i + seg < len(spring) - 1:
                first += '.'
            first += ''.join(sample[i + seg + 1:])
            possibles.append((i, first))
    return possibles

memo = {}
def efficient(springs, arrangements, parent):
    if (springs, tuple(arrangements)) in memo:
        return memo[(springs, tuple(arrangements))]
    # print(springs, arrangements)
    if num_springs(springs) < sum(arrangements):
        return 0
    if (springs == '' or '#' not in springs) and \
            len(arrangements) == 0:
        # print(parent + springs)
        return 1
    if len(arrangements) == 0:
        return 0
    springs = [x for x in springs]
    seg = arrangements[0]
    possibles = find_all_possible_placements(springs, seg)
    # print(possibles)
    c = 0
    for idx, string in possibles:
        rest = string[idx + seg:]
        c += efficient(rest, arrangements[1:], parent + string[0: idx + seg])
    memo[(''.join(springs), tuple(arrangements))] = c
    return c

 #print(efficient('?.#??##???.?????', [1, 4, 3, 1], ''))

s = 0
for line in lines:
    inputs = line.split()
    springs = '?'.join([inputs[0] for x in range(5)])
    arrangements = list(map(int, inputs[1].split(','))) * 5

    # springs = inputs[0]
    # arrangements = list(map(int, inputs[1].split(',')))

    # print(arrangements)
    # print(springs)
    # print('actual')
    # pos = pos_arrangements(springs, arrangements)
    # print('\n')
    # print('efficient')
    print(springs, arrangements)
    count = efficient(springs, arrangements, '')
    # if pos != count:
    #     print('here ye')
    print(count)
    s += count
    # print('\n\n')
print(s)


# 
# 
